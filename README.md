gdb-utils
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

TEI/XMLデータを扱う際のツール群です。

## Install

``` sh
pip install git+https://github.com/nakamura196/gdb-utils.git
from gdb_utils.core import *
```

## 使い方

``` python
client = TeiUtils()
```

## ダウンロード

``` python
url = "https://utda.github.io/goethe/data/xml/goethe.xml"
path = "data/goethe.xml"
client.download(url, path)
```

## 分析

``` python
client.get_tag_freq(path)
```

### 頻度の降順で表示

``` python
client.df
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tag</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>persName</td>
      <td>15</td>
    </tr>
    <tr>
      <th>55</th>
      <td>lb</td>
      <td>13</td>
    </tr>
    <tr>
      <th>10</th>
      <td>p</td>
      <td>9</td>
    </tr>
    <tr>
      <th>50</th>
      <td>app</td>
      <td>8</td>
    </tr>
    <tr>
      <th>51</th>
      <td>lem</td>
      <td>8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>width</td>
      <td>1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>handDesc</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>teiHeader</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>history</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>handNote</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 2 columns</p>
</div>

### 名前の昇順で表示

``` python
client.df_tag
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Tag</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>TEI</td>
      <td>1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>addrLine</td>
      <td>1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>address</td>
      <td>1</td>
    </tr>
    <tr>
      <th>50</th>
      <td>app</td>
      <td>8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>author</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>title</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>titleStmt</td>
      <td>1</td>
    </tr>
    <tr>
      <th>41</th>
      <td>variantEncoding</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>width</td>
      <td>1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>witness</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>61 rows × 2 columns</p>
</div>

## RomaでタグをチェックするためのJSスクリプトを生成

``` python
print(client.get_javascript())
```


    function checkCheckboxesWithTextValues(textValues) {
        // 存在しなかった要素名を格納する配列
        let notFound = [];

        // 指定されたテキスト値のリストをループ処理
        textValues.forEach(function(textToMatch) {
            // テキストに一致する .mdc-list-item__primary-text 要素を取得
            let found = false;
            document.querySelectorAll('.mdc-list-item__primary-text').forEach(function(item) {
                if (item.textContent.trim() === textToMatch) {
                    found = true;
                    let checkbox = item.closest('.mdc-list-item').querySelector('.mdc-checkbox__native-control');
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                }
            });

            // 要素が見つからなければ notFound 配列に追加
            if (!found) {
                notFound.push(textToMatch);
            }
        });

        // 存在しなかった要素名を返す
        return notFound;
    }

    // 指定したいテキスト値のリスト
    const itemsToCheck = ["TEI", "addrLine", "address", "app", "author", "back", "bibl", "body", "closer", "correspAction", "correspDesc", "country", "date", "dimensions", "district", "div", "editor", "editorialDecl", "encodingDesc", "extent", "fileDesc", "handDesc", "handNote", "height", "history", "idno", "institution", "lb", "lem", "listPerson", "listWit", "location", "msDesc", "msIdentifier", "objectDesc", "opener", "origin", "p", "persName", "person", "physDesc", "placeName", "profileDesc", "provenance", "publicationStmt", "publisher", "rdg", "resp", "respStmt", "salute", "signed", "sourceDesc", "space", "supportDesc", "teiHeader", "text", "title", "titleStmt", "variantEncoding", "width", "witness"];

    // チェックしたい項目のリストを関数に渡し、存在しなかった項目を取得
    const itemsNotFound = checkCheckboxesWithTextValues(itemsToCheck);

    // 存在しなかった項目をコンソールに出力
    if (itemsNotFound.length > 0) {
        console.log('These items were not found:', itemsNotFound);
    } else {
        console.log('All items were found and checked.');
    }

## Splits an XML file into multiple files based on the provided element and attributes.

``` python
path = "data/sample.xml"
output = "data/sample/out.xml"
client.split_xml_file(path, output, "pb")
```

    []

    [autoreload of gdb_utils.core failed: Traceback (most recent call last):
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 276, in check
        superreload(m, reload, self.old_objects)
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 500, in superreload
        update_generic(old_obj, new_obj)
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 397, in update_generic
        update(a, b)
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 349, in update_class
        if update_generic(old_obj, new_obj):
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 397, in update_generic
        update(a, b)
      File "/Users/nakamura/git/gdb/gdb-utils/.venv/lib/python3.9/site-packages/IPython/extensions/autoreload.py", line 309, in update_function
        setattr(old, name, getattr(new, name))
    ValueError: startElement() requires a code object with 0 free vars, not 1
    ]

``` python
path = "data/sample.xml"
output = "data/sample2/out.xml"
client.split_xml_file(path, output, "div", split_attr="type", split_value="sample")
```

    []
